# deployment/docker-compose.override.yml
version: "3.8"

services:
  vault:
    volumes:
      - vault-file:/vault/file
      - vault-logs:/vault/logs
    environment:
      - VAULT_DEV_ROOT_TOKEN_ID=${VAULT_DEV_ROOT_TOKEN_ID}
      - VAULT_ADDR=http://127.0.0.1:8200
    command: "server -dev"
  database:
    build:
      target: development
    volumes:
      - database:/var/lib/postgresql/data
    environment:
      - POSTGRES_USER=root
      - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
      - POSTGRES_DB=prescribe
  user:
    environment:
      - NODE_ENV=development
    volumes:
      - ../backend/services/user/:/app
    command: "npm run start"
  prescription:
    environment:
      - NODE_ENV=development
    volumes:
      - ../backend/services/prescription/:/app
    command: "npm run start"
  frontend:
    environment:
      - NODE_ENV=development
    volumes:
      - ../frontend/app:/app
    command: "npm run dev"

volumes:
  database:
  vault-file:
  vault-logs:
